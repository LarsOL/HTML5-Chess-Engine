window.onload=e;var f,g,h,k;
function e(){f=document.getElementById("myCanvas");g=f.getContext("2d");var b;for(b=0;64>b;b++)l[b]=0;for(b=0;8>b;b++)m.push(new n("Pawn",b,1)),p.push(new n("Pawn",b,6));m.push(new n("Rook",0,0),new n("Rook",7,0));p.push(new n("Rook",0,7),new n("Rook",7,7));m.push(new n("Bishop",2,0),new n("Bishop",5,0));p.push(new n("Bishop",2,7),new n("Bishop",5,7));m.push(new n("Knight",1,0),new n("Knight",6,0));p.push(new n("Knight",1,7),new n("Knight",6,7));m.push(new n("Queen",3,0));p.push(new n("Queen",3,7));
m.push(new n("King",4,0));p.push(new n("King",4,7));p.push(new n("Knight",4,3));window.addEventListener("resize",q,!1);window.addEventListener("orientationchange",q,!1);f.addEventListener("click",r,!1);q()}function n(b,a,d){this.type=b;this.a=a;this.b=d}var l=Array(64),m=[],p=[];function q(){document.getElementById("fill").checked?(f.width=window.innerWidth,f.height=window.innerHeight):f.height=f.width=Math.min(window.innerWidth,window.innerHeight);k=f.width/8;h=f.height/8;t()}
function t(){g.clearRect(0,0,f.width,f.height);g.fillStyle="grey";var b,a;for(a=0;8>a;a++)for(b=0;4>b;b++)a%2?g.fillRect(k*b*2,h*a,k,h):g.fillRect(k*b*2+k,h*a,k,h);for(b=0;b<m.length;b++)a=document.getElementById("w"+m[b].type),temp=[m[b].a*k,m[b].b*h],g.drawImage(a,temp[0],temp[1],k,h);for(b=0;b<p.length;b++)a=document.getElementById("b"+p[b].type),temp=[p[b].a*k,p[b].b*h],g.drawImage(a,temp[0],temp[1],k,h)}
function u(b,a){var d;d="[object Array]"===toString.call(b)?v(b):[b%8*k,Math.floor(b/8)*h];var c=g.createRadialGradient(d[0]+k/2,d[1]+h/2,h/24*7,d[0]+k/2,d[1]+h/2,h/2);c.addColorStop(0,a);c.addColorStop(1,"rgba(0, 0, 0, 0)");g.fillStyle=c;g.fillRect(d[0],d[1],k,h)}
function r(b){b=[b.pageX-f.offsetLeft,b.pageY-f.offsetTop];b=v(b);t();u(b,"rgba(255, 0, 0, .5)");var a;for(a=0;64>a;a++)l[a]=0;for(a=0;a<m.length;++a)l[m[a].a+8*m[a].b]=1;for(a=0;a<p.length;++a)l[p[a].a+8*p[a].b]=2;for(a=0;a<p.length&&(p[a].a!=b[0]/k||p[a].b!=b[1]/h);a++);a=p[a];var d=l;b=[];if("Pawn"==a.type)0==d[a.a+8*(a.b-1)]?b.push([a.a,a.b-1]):1==d[a.a-1+8*(a.b-1)]&&b.push([a.a-1,a.b-1]),1==d[a.a+1+8*(a.b-1)]&&b.push([a.a+1,a.b-1]);else if("Rook"==a.type){var c;for(c=1;0==d[a.a+c+8*a.b];++c)b.push([a.a+
c,a.b]);1==d[a.a+c+8*a.b]&&b.push([a.a+c,a.b]);for(c=1;0==d[a.a-c+8*a.b];++c)b.push([a.a-c,a.b]);1==d[a.a-c+8*a.b]&&b.push([a.a-c,a.b]);for(c=1;0==d[a.a+8*(a.b+c)];++c)b.push([a.a,a.b+c]);1==d[a.a+8*(a.b+c)]&&b.push([a.a,a.b+c]);for(c=1;0==d[a.a+8*(a.b-c)];++c)b.push([a.a,a.b-c]);1==d[a.a+8*(a.b-c)]&&b.push([a.a,a.b-c])}else"Knight"==a.type&&(c=d[a.a+1+8*(a.b+2)],0!=c&&1!=c||b.push([a.a+1,a.b+2]),c=d[a.a-1+8*(a.b+2)],0!=c&&1!=c||b.push([a.a-1,a.b+2]),c=d[a.a-1+8*(a.b-2)],0!=c&&1!=c||b.push([a.a-1,
a.b-2]),c=d[a.a+1+8*(a.b-2)],0!=c&&1!=c||b.push([a.a+1,a.b-2]),c=d[a.a+2+8*(a.b+1)],0!=c&&1!=c||b.push([a.a+2,a.b+1]),c=d[a.a-2+8*(a.b+1)],0!=c&&1!=c||b.push([a.a-2,a.b+1]),c=d[a.a-2+8*(a.b-1)],0!=c&&1!=c||b.push([a.a-2,a.b-1]),c=d[a.a+2+8*(a.b-1)],0!=c&&1!=c||b.push([a.a+2,a.b-1]));for(a=0;a<b.length;a++)u([b[a][0]*k,b[a][1]*h],"rgba(0, 255, 0, .5)")}function v(b){return[k*Math.floor(b[0]/k),h*Math.floor(b[1]/h)]};